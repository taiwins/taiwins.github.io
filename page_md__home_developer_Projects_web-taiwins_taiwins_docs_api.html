<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>Twclient quick reference &#8212; Taiwins</title>
  
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/my-style.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/target-highlight.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Twobjects quick reference" href="page_md__home_developer_Projects_web-taiwins_taiwins_docs_twobjects.html" />
    <link rel="prev" title="Taiwins, a morden wayland window manager" href="page_md__home_developer_Projects_web-taiwins_taiwins_README.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>
  <div class="page-container">
    
<!-- taken from bootstrap theme -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">
        <b>Taiwins</b></a>
      <span class="navbar-text navbar-version pull-left"><b></b></span>
    </div>

    <div class="collapse navbar-collapse nav-collapse">
      <ul class="nav navbar-nav">
	<li><a href="page_doc.html">Documentation</a></li>
	<li><a href="https://github.com/taiwins/taiwins">Source Code</a></li>
	<li><a href="https://github.com/taiwins/taiwins/wiki">Wiki</a></li>
	<!-- add other pages -->
      </ul>
    </div>
  </div>
</div>

    <div class="container">
      
	<div class="row">
	  <div class="body col-md-9 content" role="main">
	    
  <div class="section" id="twclient-quick-reference">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api"></span><span id="index-0"></span><h1>Twclient quick reference<a class="headerlink" href="#twclient-quick-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="client-data-structures">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md8"></span><h2>Client data structures<a class="headerlink" href="#client-data-structures" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="struct_tw_globals.html#doxid-dc-dde-structtw-globals"><span class="std std-ref">tw_globals</span></a> : the global structure that fits the need of an wayland client. It contains things like <code class="docutils literal notranslate"><span class="pre">wl_shm</span></code>, <code class="docutils literal notranslate"><span class="pre">wl_shm_format</span></code>, <code class="docutils literal notranslate"><span class="pre">wl_compositor</span></code>, <code class="docutils literal notranslate"><span class="pre">wl_display</span></code>.</p>
<ul>
<li><p><strong>Inputs:</strong> We only have one input per client, this would be connect to one seat, input will handle</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="struct_tw_event_queue.html#doxid-d3-d59-structtw-event-queue"><span class="std std-ref">tw_event_queue</span></a> : introduced originally for <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_shell.html#doxid-de-dcd-structtw-shell"><span class="std std-ref"><span class="pre">tw_shell</span></span></a></code> to handle system generated events like time lapse and wayland protocol events. Very much like <code class="docutils literal notranslate"><span class="pre">wl_event_loop</span></code>, which is not available in clients.</p>
<ul>
<li><p><a class="reference internal" href="struct_tw_event.html#doxid-db-dc2-structtw-event"><span class="std std-ref">tw_event</span></a> : this leads to another interface for use to create its own event and watch the event. It didn’t go as far as the <code class="docutils literal notranslate"><span class="pre">wl_protocols</span></code> where you create custom protocols and have handlers for them.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="struct_tw_shm_pool.html#doxid-d9-dab-structtw-shm-pool"><span class="std std-ref">tw_shm_pool</span></a> : the allocator for shared buffers, binds to <code class="docutils literal notranslate"><span class="pre">wl_buffer</span></code>.</p></li>
</ul>
</div>
<div class="section" id="uis">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md9"></span><h2>UIs<a class="headerlink" href="#uis" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref">tw_appsurf</span></a> : it binds to an <code class="docutils literal notranslate"><span class="pre">wl_surface</span></code> for different roles(protocols). The surface has it implementation of buffer and input events, it has the data but no actual methods to interact with it. <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> was first created for distinguishing background surface and panel surface. So in a sense, Right now it is used for any kind of single surface app. Note that:</p>
<ul>
<li><p>As an <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code>, it has it’s own <code class="docutils literal notranslate"><span class="pre">&lt;x,y,w,h&gt;</span></code> values.</p></li>
<li><p>It also has input-events, to generate the a new frame.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> is designed to work with different proxies, <code class="docutils literal notranslate"><span class="pre">taiwins_ui</span></code> (this is taiwins specific, drawn in UI layer), <code class="docutils literal notranslate"><span class="pre">wl_shell_surface</span></code> or <code class="docutils literal notranslate"><span class="pre">xdg_shell_surface</span></code> should all work, it is an wrap around <code class="docutils literal notranslate"><span class="pre">wl_surface</span></code> and provides convenient methods for commiting surface and do a new frame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tw_appsurf_event_filter</span></code>. But you know not everyting relates to a surface is about frame, would it be able to update something without drawing a new frame? This is why we have an event filter, you can instal the filter to a surface, it runs before the <code class="docutils literal notranslate"><span class="pre">tw_appsurf.frame</span></code> and it can optionally skip the <code class="docutils literal notranslate"><span class="pre">frame</span></code>.</p></li>
</ul>
<div class="section" id="example-of-ui-implementation">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md10"></span><h3>Example of UI implementation<a class="headerlink" href="#example-of-ui-implementation" title="Permalink to this headline">¶</a></h3>
<p>You can implement a <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> for your needs using <code class="docutils literal notranslate"><span class="pre">*_impl_app_surf</span></code>, there are already predefined implementatin you can take advantage of.</p>
<ul class="simple">
<li><p><strong>background:</strong> background is picture reading and posting, it could be implemented as animation, by calling a frame.</p></li>
<li><p><strong>nuklear_backend:</strong> this GUI library is implemented with OpenGL or cairo, it implements a <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> like a sub class, then use it users can use simply <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> to operate.</p></li>
<li><p><strong>embeded_surface:</strong> This is one that complicates the implementation. It does not have its own data, but also need a frame. The frame is triggered by events.</p></li>
</ul>
</div>
<div class="section" id="frame-vs-other-event">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md11"></span><h3>frame vs other event.<a class="headerlink" href="#frame-vs-other-event" title="Permalink to this headline">¶</a></h3>
<p>Right now <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> has a central <code class="docutils literal notranslate"><span class="pre">frame</span></code> callback to deal with all events, check out <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_event.html#doxid-db-dc2-structtw-event"><span class="std std-ref"><span class="pre">tw_event</span></span></a></code> structure for what is available, note that those are the common events. You may implement your specific event through <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_event_queue.html#doxid-d3-d59-structtw-event-queue"><span class="std std-ref"><span class="pre">tw_event_queue</span></span></a></code>.</p>
<p>If you do animations, in wayland, you need to call the <code class="docutils literal notranslate"><span class="pre">commit</span></code> plus a <code class="docutils literal notranslate"><span class="pre">frame</span></code> in the next done event. <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> already has <code class="docutils literal notranslate"><span class="pre">tw_appsurf_request_frame</span></code> to request a draw call. Optionally, when you call <code class="docutils literal notranslate"><span class="pre">tw_appsurf_frame</span></code>, you can specify it is animated.</p>
</div>
<div class="section" id="nuklear-backend-using-wayland">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md12"></span><h3>NUKLEAR backend using Wayland<a class="headerlink" href="#nuklear-backend-using-wayland" title="Permalink to this headline">¶</a></h3>
<p>We implement a cairo and EGL based nuklear renderer for <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code>, user can invoke <code class="docutils literal notranslate"><span class="pre">nk_egl(cairo)_impl_appsurf</span></code> to setup <code class="docutils literal notranslate"><a class="reference internal" href="struct_tw_appsurf.html#doxid-d6-d55-structtw-appsurf"><span class="std std-ref"><span class="pre">tw_appsurf</span></span></a></code> to work with <code class="docutils literal notranslate"><span class="pre">nuklear</span></code>. Then you would be able to use all the nuklear functions in the frame callback.</p>
<div class="section" id="nuklear-pipeline">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md13"></span><h4>NUKLEAR pipeline<a class="headerlink" href="#nuklear-pipeline" title="Permalink to this headline">¶</a></h4>
<p>The nuklear backend does all the heavy job of implementing all the ui forms that we need for GUI code and you can implement different backend for it. Backend implementation boils down to take draw command from <code class="docutils literal notranslate"><span class="pre">nk_command</span></code> and draw basic geometry, text and image.</p>
<ul class="simple">
<li><p>functions like <code class="docutils literal notranslate"><span class="pre">nk_label</span></code>, <code class="docutils literal notranslate"><span class="pre">nk_row</span></code> translate into <code class="docutils literal notranslate"><span class="pre">nk_command</span></code> though functions like <code class="docutils literal notranslate"><span class="pre">nk_draw_text</span></code>, <code class="docutils literal notranslate"><span class="pre">nk_draw_image</span></code>.</p></li>
<li><p>if you decide to write a CPU backend, then you have to draw based on those command, uses for example (Cairo), remember to use the double buffer(required for wayland).</p></li>
<li><p>if you use GPU backend, there is an additional helper function called <code class="docutils literal notranslate"><span class="pre">nk_convert</span></code>, which converts the command into vertex buffer, element based on layout you specified.</p></li>
</ul>
</div>
<div class="section" id="new-font-and-image">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md14"></span><h4>New Font and image<a class="headerlink" href="#new-font-and-image" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">nk_wl_*_backend</span></code> implements a resource management, to load font and image, call <code class="docutils literal notranslate"><span class="pre">nk_wl_load_image</span></code> and <code class="docutils literal notranslate"><span class="pre">nk_wl_new_font</span></code></p>
</div>
</div>
</div>
<div class="section" id="name-conversion">
<span id="doxid-d4-d6c-md-home-developer-projects-web-taiwins-taiwins-docs-api-1autotoc-md15"></span><h2>name conversion<a class="headerlink" href="#name-conversion" title="Permalink to this headline">¶</a></h2>
<p>when using <code class="docutils literal notranslate"><span class="pre">create</span></code> and <code class="docutils literal notranslate"><span class="pre">destroy</span></code>, for exemple, <code class="docutils literal notranslate"><span class="pre">wl_shm_pool_create</span></code> and <code class="docutils literal notranslate"><span class="pre">wl_shm_pool_destroy</span></code>, we are getting a pointer then free the pointer in the end.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">struct</span></code> is usually not visible, declared in header, defined in source code. Good example is <code class="docutils literal notranslate"><span class="pre">nk_egl_backend</span></code>, since there could be only one implementation of it.</p>
<p>In this case, user has the control over the memory, but the interface controls the heap if any, after calling <code class="docutils literal notranslate"><span class="pre">end</span></code>, the struct should returns to the init state.</p>
<p>Same as above.</p>
</div>
</div>


	  </div>
	  
<div class="col-md-3">
  <div id="sidebar" class="bs-sidenav">
<h3>Content</h3>
<div id="localtoc"><ul>
<li><a class="reference internal" href="#">Twclient quick reference</a><ul>
<li><a class="reference internal" href="#client-data-structures">Client data structures</a></li>
<li><a class="reference internal" href="#uis">UIs</a><ul>
<li><a class="reference internal" href="#example-of-ui-implementation">Example of UI implementation</a></li>
<li><a class="reference internal" href="#frame-vs-other-event">frame vs other event.</a></li>
<li><a class="reference internal" href="#nuklear-backend-using-wayland">NUKLEAR backend using Wayland</a><ul>
<li><a class="reference internal" href="#nuklear-pipeline">NUKLEAR pipeline</a></li>
<li><a class="reference internal" href="#new-font-and-image">New Font and image</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#name-conversion">name conversion</a></li>
</ul>
</li>
</ul>
</div>
<h3><a data-toggle="collapse" href="#globaltoc">Related Pages</a></h3>
<div id="globaltoc" class="collapse">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_CONTRIBUTING.html">Contributing to Taiwins</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_docs_lua.html">Lua bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_docs_window_management.html">Taiwins layout engine.</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_README.html">Taiwins, a morden wayland window manager</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Twclient quick reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_docs_twobjects.html">Twobjects quick reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_md__home_developer_Projects_web-taiwins_taiwins_docs_wayland.html">wayland</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global.html">Global Namespace</a></li>
</ul>

</div>
<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
  </div>
</div>

	</div>
      
    </div>
    <div class="push"></div>
  </div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Xichen Zhou.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>